		`;await r.execute(A`CREATE SCHEMA IF NOT EXISTS ${A.identifier(a)}`),await r.execute(s);let c=(await r.all(A`select id, hash, created_at from ${A.identifier(a)}.${A.identifier(i)} order by created_at desc limit 1`))[0];await r.transaction(async l=>{for await(let u of e)if(!c||Number(c.created_at)<u.folderMillis){for(let d of u.sql)await l.execute(A.raw(d));await l.execute(A`insert into ${A.identifier(a)}.${A.identifier(i)} ("hash", "created_at") values(${u.hash}, ${u.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let r=[A`with `];for(let[n,i]of e.entries())r.push(A`${A.identifier(i._.alias)} as (${i._.sql})`),n<e.length-1&&r.push(A`, `);return r.push(A` `),A.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:i}){let a=this.buildWithCTE(i),s=n?A` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=r?A` where ${r}`:void 0;return A`${a}delete from ${e}${o}${s}`}buildUpdateSet(e,r){let n=e[W.Symbol.Columns],i=Object.keys(n).filter(s=>r[s]!==void 0||n[s]?.onUpdateFn!==void 0),a=i.length;return A.join(i.flatMap((s,o)=>{let c=n[s],l=r[s]??A.param(c.onUpdateFn(),c),u=A`${A.identifier(this.casing.getColumnCasing(c))} = ${l}`;return o<a-1?[u,A.raw(", ")]:[u]}))}buildUpdateQuery({table:e,set:r,where:n,returning:i,withList:a,from:s,joins:o}){let c=this.buildWithCTE(a),l=e[Ye.Symbol.Name],u=e[Ye.Symbol.Schema],d=e[Ye.Symbol.OriginalName],m=l===d?void 0:l,g=A`${u?A`${A.identifier(u)}.`:void 0}${A.identifier(d)}${m&&A` ${A.identifier(m)}`}`,h=this.buildUpdateSet(e,r),p=s&&A.join([A.raw(" from "),this.buildFromTable(s)]),y=this.buildJoins(o),w=i?A` returning ${this.buildSelection(i,{isSingleTable:!s})}`:void 0,S=n?A` where ${n}`:void 0;return A`${c}update ${g} set ${h}${p}${y}${S}${w}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,i=e.flatMap(({field:a},s)=>{let o=[];if(M(a,K.Aliased)&&a.isSelectionField)o.push(A.identifier(a.fieldAlias));else if(M(a,K.Aliased)||M(a,K)){let c=M(a,K.Aliased)?a.sql:a;r?o.push(new K(c.queryChunks.map(l=>M(l,z)?A.identifier(this.casing.getColumnCasing(l)):l))):o.push(c),M(a,K.Aliased)&&o.push(A` as ${A.identifier(a.fieldAlias)}`)}else M(a,ve)&&(r?o.push(A.identifier(this.casing.getColumnCasing(a))):o.push(a));return s<n-1&&o.push(A`, `),o});return A.join(i)}buildJoins(e){if(!e||e.length===0)return;let r=[];for(let[n,i]of e.entries()){n===0&&r.push(A` `);let a=i.table,s=i.lateral?A` lateral`:void 0;if(M(a,Ye)){let o=a[Ye.Symbol.Name],c=a[Ye.Symbol.Schema],l=a[Ye.Symbol.OriginalName],u=o===l?void 0:i.alias;r.push(A`${A.raw(i.joinType)} join${s} ${c?A`${A.identifier(c)}.`:void 0}${A.identifier(l)}${u&&A` ${A.identifier(u)}`} on ${i.on}`)}else if(M(a,ft)){let o=a[Ee].name,c=a[Ee].schema,l=a[Ee].originalName,u=o===l?void 0:i.alias;r.push(A`${A.raw(i.joinType)} join${s} ${c?A`${A.identifier(c)}.`:void 0}${A.identifier(l)}${u&&A` ${A.identifier(u)}`} on ${i.on}`)}else r.push(A`${A.raw(i.joinType)} join${s} ${a} on ${i.on}`);n<e.length-1&&r.push(A` `)}return A.join(r)}buildFromTable(e){if(M(e,W)&&e[W.Symbol.OriginalName]!==e[W.Symbol.Name]){let r=A`${A.identifier(e[W.Symbol.OriginalName])}`;return e[W.Symbol.Schema]&&(r=A`${A.identifier(e[W.Symbol.Schema])}.${r}`),A`${r} ${A.identifier(e[W.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:i,having:a,table:s,joins:o,orderBy:c,groupBy:l,limit:u,offset:d,lockingClause:m,distinct:g,setOperators:h}){let p=n??Pt(r);for(let L of p)if(M(L.field,ve)&&yt(L.field.table)!==(M(s,$e)?s._.alias:M(s,bi)?s[Ee].name:M(s,K)?void 0:yt(s))&&!($=>o?.some(({alias:X})=>X===($[W.Symbol.IsAlias]?yt($):$[W.Symbol.BaseName])))(L.field.table)){let $=yt(L.field.table);throw new Error(`Your "${L.path.join("->")}" field references a column "${$}"."${L.field.name}", but the table "${$}" is not part of the query! Did you forget to join it?`)}let y=!o||o.length===0,w=this.buildWithCTE(e),S;g&&(S=g===!0?A` distinct`:A` distinct on (${A.join(g.on,A`, `)})`);let _=this.buildSelection(p,{isSingleTable:y}),N=this.buildFromTable(s),j=this.buildJoins(o),E=i?A` where ${i}`:void 0,T=a?A` having ${a}`:void 0,O;c&&c.length>0&&(O=A` order by ${A.join(c,A`, `)}`);let k;l&&l.length>0&&(k=A` group by ${A.join(l,A`, `)}`);let R=typeof u=="object"||typeof u=="number"&&u>=0?A` limit ${u}`:void 0,B=d?A` offset ${d}`:void 0,G=A.empty();if(m){let L=A` for ${A.raw(m.strength)}`;m.config.of&&L.append(A` of ${A.join(Array.isArray(m.config.of)?m.config.of:[m.config.of],A`, `)}`),m.config.noWait?L.append(A` no wait`):m.config.skipLocked&&L.append(A` skip locked`),G.append(L)}let Q=A`${w}select${S} ${_} from ${N}${j}${E}${k}${T}${O}${R}${B}${G}`;return h.length>0?this.buildSetOperations(Q,h):Q}buildSetOperations(e,r){let[n,...i]=r;if(!n)throw new Error("Cannot pass undefined values to any set operator");return i.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),i)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:i,limit:a,orderBy:s,offset:o}}){let c=A`(${e.getSQL()}) `,l=A`(${i.getSQL()})`,u;if(s&&s.length>0){let h=[];for(let p of s)if(M(p,z))h.push(A.identifier(p.name));else if(M(p,K)){for(let y=0;y<p.queryChunks.length;y++){let w=p.queryChunks[y];M(w,z)&&(p.queryChunks[y]=A.identifier(w.name))}h.push(A`${p}`)}else h.push(A`${p}`);u=A` order by ${A.join(h,A`, `)} `}let d=typeof a=="object"||typeof a=="number"&&a>=0?A` limit ${a}`:void 0,m=A.raw(`${r} ${n?"all ":""}`),g=o?A` offset ${o}`:void 0;return A`${c}${m}${l}${u}${d}${g}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:i,withList:a,select:s,overridingSystemValue_:o}){let c=[],l=e[W.Symbol.Columns],u=Object.entries(l).filter(([w,S])=>!S.shouldDisableInsert()),d=u.map(([,w])=>A.identifier(this.casing.getColumnCasing(w)));if(s){let w=r;M(w,K)?c.push(w):c.push(w.getSQL())}else{let w=r;c.push(A.raw("values "));for(let[S,_]of w.entries()){let N=[];for(let[j,E]of u){let T=_[j];if(T===void 0||M(T,xt)&&T.value===void 0)if(E.defaultFn!==void 0){let O=E.defaultFn(),k=M(O,K)?O:A.param(O,E);N.push(k)}else if(!E.default&&E.onUpdateFn!==void 0){let O=E.onUpdateFn(),k=M(O,K)?O:A.param(O,E);N.push(k)}else N.push(A`default`);else N.push(T)}c.push(N),S<w.length-1&&c.push(A`, `)}}let m=this.buildWithCTE(a),g=A.join(c),h=i?A` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,p=n?A` on conflict ${n}`:void 0,y=o===!0?A`overriding system value `:void 0;return A`${m}insert into ${e} ${d} ${y}${g}${p}${h}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let i=r?A` concurrently`:void 0,a=n?A` with no data`:void 0;return A`refresh materialized view${i} ${e}${a}`}prepareTyping(e){return M(e,za)||M(e,Ua)?"json":M(e,Qa)?"decimal":M(e,Va)?"time":M(e,Wa)||M(e,Ga)?"timestamp":M(e,Fa)||M(e,$a)?"date":M(e,Ha)?"uuid":"none"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:i,tableConfig:a,queryConfig:s,tableAlias:o,nestedQueryRelation:c,joinOn:l}){let u=[],d,m,g=[],h,p=[];if(s===!0)u=Object.entries(a.columns).map(([S,_])=>({dbKey:_.name,tsKey:S,field:Xt(_,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let w=Object.fromEntries(Object.entries(a.columns).map(([T,O])=>[T,Xt(O,o)]));if(s.where){let T=typeof s.where=="function"?s.where(w,tw()):s.where;h=T&&Ra(T,o)}let S=[],_=[];if(s.columns){let T=!1;for(let[O,k]of Object.entries(s.columns))k!==void 0&&O in a.columns&&(!T&&k===!0&&(T=!0),_.push(O));_.length>0&&(_=T?_.filter(O=>s.columns?.[O]===!0):Object.keys(a.columns).filter(O=>!_.includes(O)))}else _=Object.keys(a.columns);for(let T of _){let O=a.columns[T];S.push({tsKey:T,value:O})}let N=[];s.with&&(N=Object.entries(s.with).filter(T=>!!T[1]).map(([T,O])=>({tsKey:T,queryConfig:O,relation:a.relations[T]})));let j;if(s.extras){j=typeof s.extras=="function"?s.extras(w,{sql:A}):s.extras;for(let[T,O]of Object.entries(j))S.push({tsKey:T,value:bp(O,o)})}for(let{tsKey:T,value:O}of S)u.push({dbKey:M(O,K.Aliased)?O.fieldAlias:a.columns[T].name,tsKey:T,field:M(O,ve)?Xt(O,o):O,relationTableTsKey:void 0,isJson:!1,selection:[]});let E=typeof s.orderBy=="function"?s.orderBy(w,rw()):s.orderBy??[];Array.isArray(E)||(E=[E]),g=E.map(T=>M(T,ve)?Xt(T,o):Ra(T,o)),d=s.limit,m=s.offset;for(let{tsKey:T,queryConfig:O,relation:k}of N){let R=iw(r,n,k),B=cn(k.referencedTable),G=n[B],Q=`${o}_${T}`,L=Za(...R.fields.map((re,de)=>dr(Xt(R.references[de],Q),Xt(re,o)))),$=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[G],tableConfig:r[G],queryConfig:M(k,Ir)?O===!0?{limit:1}:{...O,limit:1}:O,tableAlias:Q,joinOn:L,nestedQueryRelation:k}),X=A`${A.identifier(Q)}.${A.identifier("data")}`.as(T);p.push({on:A`true`,table:new $e($.sql,{},Q),alias:Q,joinType:"left",lateral:!0}),u.push({dbKey:T,tsKey:T,field:X,relationTableTsKey:G,isJson:!0,selection:$.selection})}}if(u.length===0)throw new Da({message:`No fields selected for table "${a.tsName}" ("${o}")`});let y;if(h=Za(l,h),c){let w=A`json_build_array(${A.join(u.map(({field:N,tsKey:j,isJson:E})=>E?A`${A.identifier(`${o}_${j}`)}.${A.identifier("data")}`:M(N,K.Aliased)?N.sql:N),A`, `)})`;M(c,Xa)&&(w=A`coalesce(json_agg(${w}${g.length>0?A` order by ${A.join(g,A`, `)}`:void 0}), '[]'::json)`);let S=[{dbKey:"data",tsKey:"data",field:w.as("data"),isJson:!0,relationTableTsKey:a.tsName,selection:u}];d!==void 0||m!==void 0||g.length>0?(y=this.buildSelectQuery({table:La(i,o),fields:{},fieldsFlat:[{path:[],field:A.raw("*")}],where:h,limit:d,offset:m,orderBy:g,setOperators:[]}),h=void 0,d=void 0,m=void 0,g=[]):y=La(i,o),y=this.buildSelectQuery({table:M(y,Ye)?y:new $e(y,{},o),fields:{},fieldsFlat:S.map(({field:N})=>({path:[],field:M(N,ve)?Xt(N,o):N})),joins:p,where:h,limit:d,offset:m,orderBy:g,setOperators:[]})}else y=this.buildSelectQuery({table:La(i,o),fields:{},fieldsFlat:u.map(({field:w})=>({path:[],field:M(w,ve)?Xt(w,o):w})),joins:p,where:h,limit:d,offset:m,orderBy:g,setOperators:[]});return{tableTsKey:a.tsName,sql:y,selection:u}}};var Zo=class{static[C]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}};var at=class{static[C]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let r=!!this.fields,n=e,i;return this.fields?i=this.fields:M(n,$e)?i=Object.fromEntries(Object.keys(n._.selectedFields).map(a=>[a,n[a]])):M(n,bi)?i=n[Ee].selectedFields:M(n,K)?i={}:i=Uo(n),new Xo({table:n,fields:i,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},Uf=class extends Zo{static[C]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:i,dialect:a,withList:s,distinct:o}){super(),this.config={withList:s,table:e,fields:{...r},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=i,this.dialect=a,this._={selectedFields:r},this.tableName=pr(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let i=this.tableName,a=pr(r);if(typeof a=="string"&&this.config.joins?.some(s=>s.alias===a))throw new Error(`Alias "${a}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof i=="string"&&(this.config.fields={[i]:this.config.fields}),typeof a=="string"&&!M(r,K))){let s=M(r,$e)?r._.selectedFields:M(r,ft)?r[Ee].selectedFields:r[W.Symbol.Columns];this.config.fields[a]=s}if(typeof n=="function"&&(n=n(new Proxy(this.config.fields,new Be({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:a}),typeof a=="string")switch(e){case"left":{this.joinsNotNullableMap[a]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!0;break}case"inner":{this.joinsNotNullableMap[a]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,r){return n=>{let i=typeof n=="function"?n(BA()):n;if(!Ba(this.getSelectedFields(),i.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:r,rightSelect:i}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new Be({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new Be({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new Be({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new Be({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}as(e){return new Proxy(new $e(this.getSQL(),this.config.fields,e),new Be({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new Be({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}},Xo=class extends Uf{static[C]="PgSelect";_prepare(e){let{session:r,config:n,dialect:i,joinsNotNullableMap:a,authToken:s}=this;if(!r)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return Ue.startActiveSpan("drizzle.prepareQuery",()=>{let o=Pt(n.fields),c=r.prepareQuery(i.sqlToQuery(this.getSQL()),o,e,!0);return c.joinsNotNullableMap=a,c.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>Ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};e1(Xo,[it]);function wi(t,e){return(r,n,...i)=>{let a=[n,...i].map(s=>({type:t,isAll:e,rightSelect:s}));for(let s of a)if(!Ba(r.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(a)}}var BA=()=>({union:MA,unionAll:DA,intersect:FA,intersectAll:$A,except:UA,exceptAll:zA}),MA=wi("union",!1),DA=wi("union",!0),FA=wi("intersect",!1),$A=wi("intersect",!0),UA=wi("except",!1),zA=wi("except",!0);var _i=class{static[C]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=M(e,jr)?e:void 0,this.dialectConfig=M(e,jr)?void 0:e}$with=(e,r)=>{let n=this;return{as:a=>(typeof a=="function"&&(a=a(n)),new Proxy(new yi(a.getSQL(),r??("getSelectedFields"in a?a.getSelectedFields()??{}:{}),e,!0),new Be({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let r=this;function n(s){return new at({fields:s??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function i(s){return new at({fields:s??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function a(s,o){return new at({fields:o??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:s}})}return{select:n,selectDistinct:i,selectDistinctOn:a}}select(e){return new at({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new at({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new at({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new jr(this.dialectConfig)),this.dialect}};var Ja=class{constructor(e,r,n,i,a){this.table=e,this.session=r,this.dialect=n,this.withList=i,this.overridingSystemValue_=a}static[C]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");let r=e.map(n=>{let i={},a=this.table[W.Symbol.Columns];for(let s of Object.keys(n)){let o=n[s];i[s]=M(o,K)?o:new xt(o,a[s])}return i});return new Jo(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let r=typeof e=="function"?e(new _i):e;if(!M(r,K)&&!Ba(this.table[Do],r._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new Jo(this.table,r,this.session,this.dialect,this.withList,!0)}},Jo=class extends it{constructor(e,r,n,i,a,s,o){super(),this.session=n,this.dialect=i,this.config={table:e,values:r,withList:a,select:s,overridingSystemValue_:o}}static[C]="PgInsert";config;returning(e=this.config.table[W.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=Pt(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=A`do nothing`;else{let r="";r=Array.isArray(e.target)?e.target.map(i=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(i))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?A` where ${e.where}`:void 0;this.config.onConflict=A`(${A.raw(r)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let r=e.where?A` where ${e.where}`:void 0,n=e.targetWhere?A` where ${e.targetWhere}`:void 0,i=e.setWhere?A` where ${e.setWhere}`:void 0,a=this.dialect.buildUpdateSet(this.config.table,$o(this.config.table,e.set)),s="";return s=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=A`(${A.raw(s)})${n} do update set ${a}${r}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return Ue.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>Ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Be({alias:yt(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var Yo=class extends it{constructor(e,r,n){super(),this.session=r,this.dialect=n,this.config={view:e}}static[C]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return Ue.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>Ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};var Ya=class{constructor(e,r,n,i){this.table=e,this.session=r,this.dialect=n,this.withList=i}static[C]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new zf(this.table,$o(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},zf=class extends it{constructor(e,r,n,i,a){super(),this.session=n,this.dialect=i,this.config={set:r,table:e,withList:a,joins:[]},this.tableName=pr(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}static[C]="PgUpdate";config;tableName;joinsNotNullableMap;from(e){let r=e,n=pr(r);return typeof n=="string"&&(this.joinsNotNullableMap[n]=!0),this.config.from=r,this}getTableLikeFields(e){return M(e,Ye)?e[W.Symbol.Columns]:M(e,$e)?e._.selectedFields:e[Ee].selectedFields}createJoin(e){return(r,n)=>{let i=pr(r);if(typeof i=="string"&&this.config.joins.some(a=>a.alias===i))throw new Error(`Alias "${i}" is already used in this query`);if(typeof n=="function"){let a=this.config.from&&!M(this.config.from,K)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[W.Symbol.Columns],new Be({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),a&&new Proxy(a,new Be({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:n,table:r,joinType:e,alias:i}),typeof i=="string")switch(e){case"left":{this.joinsNotNullableMap[i]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!0;break}case"inner":{this.joinsNotNullableMap[i]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[W.Symbol.Columns]),this.config.from)){let r=pr(this.config.from);if(typeof r=="string"&&this.config.from&&!M(this.config.from,K)){let n=this.getTableLikeFields(this.config.from);e[r]=n}for(let n of this.config.joins){let i=pr(n.table);if(typeof i=="string"&&!M(n.table,K)){let a=this.getTableLikeFields(n.table);e[i]=a}}}return this.config.returningFields=e,this.config.returning=Pt(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){let r=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return r.joinsNotNullableMap=this.joinsNotNullableMap,r}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Be({alias:yt(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var ec=class t extends K{constructor(e){super(t.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=t.buildCount(e.source,e.filters)}sql;token;static[C]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,r){return A`(select count(*) from ${e}${A.raw(" where ").if(r)}${r})`}static buildCount(e,r){return A`select count(*) as count from ${e}${A.raw(" where ").if(r)}${r};`}setToken(e){return this.token=e,this}then(e,r){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,r)}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}};var tc=class{constructor(e,r,n,i,a,s,o){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o}static[C]="PgRelationalQueryBuilder";findMany(e){return new rc(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new rc(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}},rc=class extends it{constructor(e,r,n,i,a,s,o,c,l){super(),this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=i,this.tableConfig=a,this.dialect=s,this.session=o,this.config=c,this.mode=l}static[C]="PgRelationalQuery";_prepare(e){return Ue.startActiveSpan("drizzle.prepareQuery",()=>{let{query:r,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(i,a)=>{let s=i.map(o=>Ko(this.schema,this.tableConfig,o,r.selection,a));return this.mode==="first"?s[0]:s})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),r=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:r}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return Ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}};var nc=class extends it{constructor(e,r,n,i){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=i}static[C]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var Si=class{constructor(e,r,n){if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(let[i,a]of Object.entries(this._.schema))this.query[i]=new tc(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[i],a,e,r)}static[C]="PgDatabase";query;$with=(e,r)=>{let n=this;return{as:a=>(typeof a=="function"&&(a=a(new _i(n.dialect))),new Proxy(new yi(a.getSQL(),r??("getSelectedFields"in a?a.getSelectedFields()??{}:{}),e,!0),new Be({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,r){return new ec({source:e,filters:r,session:this.session})}with(...e){let r=this;function n(l){return new at({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e})}function i(l){return new at({fields:l??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function a(l,u){return new at({fields:u??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:l}})}function s(l){return new Ya(l,r.session,r.dialect,e)}function o(l){return new Ja(l,r.session,r.dialect,e)}function c(l){return new Ma(l,r.session,r.dialect,e)}return{select:n,selectDistinct:i,selectDistinctOn:a,update:s,insert:o,delete:c}}select(e){return new at({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new at({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new at({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Ya(e,this.session,this.dialect)}insert(e){return new Ja(e,this.session,this.dialect)}delete(e){return new Ma(e,this.session,this.dialect)}refreshMaterializedView(e){return new Yo(e,this.session,this.dialect)}authToken;execute(e){let r=typeof e=="string"?A.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),i=this.session.prepareQuery(n,void 0,void 0,!1);return new nc(()=>i.execute(void 0,this.authToken),r,n,a=>i.mapResult(a,!0))}transaction(e,r){return this.session.transaction(e,r)}};var ic=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}static[C]="PgPreparedQuery";joinsNotNullableMap},ac=class{constructor(e){this.dialect=e}static[C]="PgSession";execute(e,r){return Ue.startActiveSpan("drizzle.operation",()=>Ue.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){let n=await this.execute(e,r);return Number(n[0].count)}},sc=class extends Si{constructor(e,r,n,i=0){super(e,r,n),this.schema=n,this.nestedIndex=i}static[C]="PgTransaction";rollback(){throw new Qo}getTransactionConfigSQL(e){let r=[];return e.isolationLevel&&r.push(`isolation level ${e.isolationLevel}`),e.accessMode&&r.push(e.accessMode),typeof e.deferrable=="boolean"&&r.push(e.deferrable?"deferrable":"not deferrable"),A.raw(r.join(" "))}setTransaction(e){return this.session.execute(A`set transaction ${this.getTransactionConfigSQL(e)}`)}};var Qf=class extends ic{constructor(e,r,n,i,a,s,o,c){super({sql:r,params:n}),this.client=e,this.params=n,this.logger=i,this.fields=a,this._isResponseInArrayMode=o,this.customResultMapper=c,this.rawQueryConfig={name:s,text:r,types:{getTypeParser:(l,u)=>l===Ft.builtins.TIMESTAMPTZ?d=>d:l===Ft.builtins.TIMESTAMP?d=>d:l===Ft.builtins.DATE?d=>d:l===Ft.builtins.INTERVAL?d=>d:Ft.getTypeParser(l,u)}},this.queryConfig={name:s,text:r,rowMode:"array",types:{getTypeParser:(l,u)=>l===Ft.builtins.TIMESTAMPTZ?d=>d:l===Ft.builtins.TIMESTAMP?d=>d:l===Ft.builtins.DATE?d=>d:l===Ft.builtins.INTERVAL?d=>d:Ft.getTypeParser(l,u)}}}static[C]="NeonPreparedQuery";rawQueryConfig;queryConfig;async execute(e={}){let r=Fo(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,r);let{fields:n,client:i,rawQueryConfig:a,queryConfig:s,joinsNotNullableMap:o,customResultMapper:c}=this;if(!n&&!c)return i.query(a,r);let l=await i.query(s,r);return c?c(l.rows):l.rows.map(u=>Yb(n,u,o))}all(e={}){let r=Fo(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,r),this.client.query(this.rawQueryConfig,r).then(n=>n.rows)}values(e={}){let r=Fo(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,r),this.client.query(this.queryConfig,r).then(n=>n.rows)}isResponseInArrayMode(){return this._isResponseInArrayMode}},oc=class t extends ac{constructor(e,r,n,i={}){super(r),this.client=e,this.schema=n,this.options=i,this.logger=i.logger??new qo}static[C]="NeonSession";logger;prepareQuery(e,r,n,i,a){return new Qf(this.client,e.sql,e.params,this.logger,r,n,i,a)}async query(e,r){return this.logger.logQuery(e,r),await this.client.query({rowMode:"array",text:e,values:r})}async queryObjects(e,r){return this.client.query(e,r)}async count(e){let r=await this.execute(e);return Number(r.rows[0].count)}async transaction(e,r={}){let n=this.client instanceof on?new t(await this.client.connect(),this.dialect,this.schema,this.options):this,i=new Vf(this.dialect,n,this.schema);await i.execute(A`begin ${i.getTransactionConfigSQL(r)}`);try{let a=await e(i);return await i.execute(A`commit`),a}catch(a){throw await i.execute(A`rollback`),a}finally{this.client instanceof on&&n.client.release()}}},Vf=class t extends sc{static[C]="NeonTransaction";async transaction(e){let r=`sp${this.nestedIndex+1}`,n=new t(this.dialect,this.session,this.schema,this.nestedIndex+1);await n.execute(A.raw(`savepoint ${r}`));try{let i=await e(n);return await n.execute(A.raw(`release savepoint ${r}`)),i}catch(i){throw await n.execute(A.raw(`rollback to savepoint ${r}`)),i}}};var Wf=class{constructor(e,r,n={}){this.client=e,this.dialect=r,this.options=n}static[C]="NeonDriver";createSession(e){return new oc(this.client,this.dialect,e,{logger:this.options.logger})}},Gf=class extends Si{static[C]="NeonServerlessDatabase"};function es(t,e={}){let r=new jr({casing:e.casing}),n;e.logger===!0?n=new jo:e.logger!==!1&&(n=e.logger);let i;if(e.schema){let c=nw(e.schema,aw);i={fullSchema:e.schema,schema:c.tables,tableNamesMap:c.tableNamesMap}}let s=new Wf(t,r,{logger:n}).createSession(i),o=new Gf(r,s,i);return o.$client=t,o}function cc(...t){if(typeof t[0]=="string"){let e=new on({connectionString:t[0]});return es(e,t[1])}if(r1(t[0])){let{connection:e,client:r,ws:n,...i}=t[0];if(n&&(vi.webSocketConstructor=n),r)return es(r,i);let a=typeof e=="string"?new on({connectionString:e}):new on(e);return es(a,i)}return es(t[0],t[1])}(t=>{function e(r){return es({},r)}t.mock=e})(cc||(cc={}));var vP=or(lw(),1),gP=or(fd(),1),yP=or(hd(),1),O_=or(_d(),1),xP=or(P_(),1);var N_=O_.default;var Ad={};qc(Ad,{insertMessageSchema:()=>Tc,insertUserSchema:()=>MO,messages:()=>ar,users:()=>Fr});var Qe={};qc(Qe,{BRAND:()=>VP,DIRTY:()=>hn,EMPTY_PATH:()=>SP,INVALID:()=>ee,NEVER:()=>PO,OK:()=>st,ParseStatus:()=>tt,Schema:()=>le,ZodAny:()=>Mr,ZodArray:()=>_r,ZodBigInt:()=>gn,ZodBoolean:()=>yn,ZodBranded:()=>ps,ZodCatch:()=>Pn,ZodDate:()=>xn,ZodDefault:()=>An,ZodDiscriminatedUnion:()=>Ec,ZodEffects:()=>qt,ZodEnum:()=>Cn,ZodError:()=>wt,ZodFirstPartyTypeKind:()=>ne,ZodFunction:()=>Cc,ZodIntersection:()=>Sn,ZodIssueCode:()=>F,ZodLazy:()=>En,ZodLiteral:()=>kn,ZodMap:()=>qi,ZodNaN:()=>Ri,ZodNativeEnum:()=>Tn,ZodNever:()=>zt,ZodNull:()=>wn,ZodNullable:()=>ir,ZodNumber:()=>vn,ZodObject:()=>_t,ZodOptional:()=>It,ZodParsedType:()=>H,ZodPipeline:()=>fs,ZodPromise:()=>Dr,ZodReadonly:()=>On,ZodRecord:()=>kc,ZodSchema:()=>le,ZodSet:()=>Li,ZodString:()=>Br,ZodSymbol:()=>Ii,ZodTransformer:()=>qt,ZodTuple:()=>nr,ZodType:()=>le,ZodUndefined:()=>bn,ZodUnion:()=>_n,ZodUnknown:()=>wr,ZodVoid:()=>ji,addIssueToContext:()=>V,any:()=>eO,array:()=>iO,bigint:()=>KP,boolean:()=>U_,coerce:()=>AO,custom:()=>D_,date:()=>ZP,datetimeRegex:()=>B_,defaultErrorMap:()=>xr,discriminatedUnion:()=>cO,effect:()=>bO,enum:()=>gO,function:()=>mO,getErrorMap:()=>Pi,getParsedType:()=>rr,instanceof:()=>GP,intersection:()=>lO,isAborted:()=>_c,isAsync:()=>Oi,isDirty:()=>Sc,isValid:()=>Rr,late:()=>WP,lazy:()=>hO,literal:()=>vO,makeIssue:()=>us,map:()=>fO,nan:()=>HP,nativeEnum:()=>yO,never:()=>rO,null:()=>YP,nullable:()=>_O,number:()=>$_,object:()=>aO,objectUtil:()=>Ed,oboolean:()=>TO,onumber:()=>CO,optional:()=>wO,ostring:()=>kO,pipeline:()=>EO,preprocess:()=>SO,promise:()=>xO,quotelessJson:()=>bP,record:()=>pO,set:()=>dO,setErrorMap:()=>_P,strictObject:()=>sO,string:()=>F_,symbol:()=>XP,transformer:()=>bO,tuple:()=>uO,undefined:()=>JP,union:()=>oO,unknown:()=>tO,util:()=>ue,void:()=>nO});var ue;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{let a={};for(let s of i)a[s]=s;return a},t.getValidEnumValues=i=>{let a=t.objectKeys(i).filter(o=>typeof i[i[o]]!="number"),s={};for(let o of a)s[o]=i[o];return t.objectValues(s)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{let a=[];for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.push(s);return a},t.find=(i,a)=>{for(let s of i)if(a(s))return s},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function n(i,a=" | "){return i.map(s=>typeof s=="string"?`'${s}'`:s).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(i,a)=>typeof a=="bigint"?a.toString():a})(ue||(ue={}));var Ed;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(Ed||(Ed={}));var H=ue.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),rr=t=>{switch(typeof t){case"undefined":return H.undefined;case"string":return H.string;case"number":return Number.isNaN(t)?H.nan:H.number;case"boolean":return H.boolean;case"function":return H.function;case"bigint":return H.bigint;case"symbol":return H.symbol;case"object":return Array.isArray(t)?H.array:t===null?H.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?H.promise:typeof Map<"u"&&t instanceof Map?H.map:typeof Set<"u"&&t instanceof Set?H.set:typeof Date<"u"&&t instanceof Date?H.date:H.object;default:return H.unknown}};var F=ue.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),bP=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),wt=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(let s of a.issues)if(s.code==="invalid_union")s.unionErrors.map(i);else if(s.code==="invalid_return_type")i(s.returnTypeError);else if(s.code==="invalid_arguments")i(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,c=0;for(;c<s.path.length;){let l=s.path[c];c===s.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(r(s))):o[l]=o[l]||{_errors:[]},o=o[l],c++}}};return i(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ue.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let i of this.issues)if(i.path.length>0){let a=i.path[0];r[a]=r[a]||[],r[a].push(e(i))}else n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};wt.create=t=>new wt(t);var wP=(t,e)=>{let r;switch(t.code){case F.invalid_type:t.received===H.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case F.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,ue.jsonStringifyReplacer)}`;break;case F.unrecognized_keys:r=`Unrecognized key(s) in object: ${ue.joinValues(t.keys,", ")}`;break;case F.invalid_union:r="Invalid input";break;case F.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${ue.joinValues(t.options)}`;break;case F.invalid_enum_value:r=`Invalid enum value. Expected ${ue.joinValues(t.options)}, received '${t.received}'`;break;case F.invalid_arguments:r="Invalid function arguments";break;case F.invalid_return_type:r="Invalid function return type";break;case F.invalid_date:r="Invalid date";break;case F.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:ue.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case F.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case F.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case F.custom:r="Invalid input";break;case F.invalid_intersection_types:r="Intersection results could not be merged";break;case F.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case F.not_finite:r="Number must be finite";break;default:r=e.defaultError,ue.assertNever(t)}return{message:r}},xr=wP;var I_=xr;function _P(t){I_=t}function Pi(){return I_}var us=t=>{let{data:e,path:r,errorMaps:n,issueData:i}=t,a=[...r,...i.path||[]],s={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let o="",c=n.filter(l=>!!l).slice().reverse();for(let l of c)o=l(s,{data:e,defaultError:o}).message;return{...i,path:a,message:o}},SP=[];function V(t,e){let r=Pi(),n=us({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===xr?void 0:xr].filter(i=>!!i)});t.common.issues.push(n)}var tt=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let i of r){if(i.status==="aborted")return ee;i.status==="dirty"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let i of r){let a=await i.key,s=await i.value;n.push({key:a,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let i of r){let{key:a,value:s}=i;if(a.status==="aborted"||s.status==="aborted")return ee;a.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof s.value<"u"||i.alwaysSet)&&(n[a.value]=s.value)}return{status:e.value,value:n}}},ee=Object.freeze({status:"aborted"}),hn=t=>({status:"dirty",value:t}),st=t=>({status:"valid",value:t}),_c=t=>t.status==="aborted",Sc=t=>t.status==="dirty",Rr=t=>t.status==="valid",Oi=t=>typeof Promise<"u"&&t instanceof Promise;var J;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(J||(J={}));var jt=class{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},j_=(t,e)=>{if(Rr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new wt(t.common.issues);return this._error=r,this._error}}};function se(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(s,o)=>{let{message:c}=t;return s.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:c??n??o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:c??r??o.defaultError}},description:i}}var le=class{get description(){return this._def.description}_getType(e){return rr(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:rr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new tt,ctx:{common:e.parent.common,data:e.data,parsedType:rr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Oi(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){let n={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:rr(e)},i=this._parseSync({data:e,path:n.path,parent:n});return j_(n,i)}"~validate"(e){let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:rr(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:r});return Rr(n)?{value:n.value}:{issues:r.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(n=>Rr(n)?{value:n.value}:{issues:r.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:rr(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(Oi(i)?i:Promise.resolve(i));return j_(n,a)}refine(e,r){let n=i=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(i):r;return this._refinement((i,a)=>{let s=e(i),o=()=>a.addIssue({code:F.custom,...n(i)});return typeof Promise<"u"&&s instanceof Promise?s.then(c=>c?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r=="function"?r(n,i):r),!1))}_refinement(e){return new qt({schema:this,typeName:ne.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return It.create(this,this._def)}nullable(){return ir.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return _r.create(this)}promise(){return Dr.create(this,this._def)}or(e){return _n.create([this,e],this._def)}and(e){return Sn.create(this,e,this._def)}transform(e){return new qt({...se(this._def),schema:this,typeName:ne.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new An({...se(this._def),innerType:this,defaultValue:r,typeName:ne.ZodDefault})}brand(){return new ps({typeName:ne.ZodBranded,type:this,...se(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new Pn({...se(this._def),innerType:this,catchValue:r,typeName:ne.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return fs.create(this,e)}readonly(){return On.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},EP=/^c[^\s-]{8,}$/i,kP=/^[0-9a-z]+$/,CP=/^[0-9A-HJKMNP-TV-Z]{26}$/i,TP=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,AP=/^[a-z0-9_-]{21}$/i,PP=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,OP=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,NP=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,IP="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",kd,jP=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,qP=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,LP=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,RP=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,BP=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,MP=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,L_="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",DP=new RegExp(`^${L_}$`);function R_(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);let r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function FP(t){return new RegExp(`^${R_(t)}$`)}function B_(t){let e=`${L_}T${R_(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function $P(t,e){return!!((e==="v4"||!e)&&jP.test(t)||(e==="v6"||!e)&&LP.test(t))}function UP(t,e){if(!PP.test(t))return!1;try{let[r]=t.split(".");if(!r)return!1;let n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),i=JSON.parse(atob(n));return!(typeof i!="object"||i===null||"typ"in i&&i?.typ!=="JWT"||!i.alg||e&&i.alg!==e)}catch{return!1}}function zP(t,e){return!!((e==="v4"||!e)&&qP.test(t)||(e==="v6"||!e)&&RP.test(t))}var Br=class t extends le{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==H.string){let a=this._getOrReturnCtx(e);return V(a,{code:F.invalid_type,expected:H.string,received:a.parsedType}),ee}let n=new tt,i;for(let a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),V(i,{code:F.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="max")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),V(i,{code:F.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="length"){let s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(i=this._getOrReturnCtx(e,i),s?V(i,{code:F.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&V(i,{code:F.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind==="email")NP.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"email",code:F.invalid_string,message:a.message}),n.dirty());else if(a.kind==="emoji")kd||(kd=new RegExp(IP,"u")),kd.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"emoji",code:F.invalid_string,message:a.message}),n.dirty());else if(a.kind==="uuid")TP.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"uuid",code:F.invalid_string,message:a.message}),n.dirty());else if(a.kind==="nanoid")AP.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"nanoid",code:F.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid")EP.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"cuid",code:F.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid2")kP.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"cuid2",code:F.invalid_string,message:a.message}),n.dirty());else if(a.kind==="ulid")CP.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"ulid",code:F.invalid_string,message:a.message}),n.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),V(i,{validation:"url",code:F.invalid_string,message:a.message}),n.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"regex",code:F.invalid_string,message:a.message}),n.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),V(i,{code:F.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),V(i,{code:F.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),V(i,{code:F.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind==="datetime"?B_(a).test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{code:F.invalid_string,validation:"datetime",message:a.message}),n.dirty()):a.kind==="date"?DP.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{code:F.invalid_string,validation:"date",message:a.message}),n.dirty()):a.kind==="time"?FP(a).test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{code:F.invalid_string,validation:"time",message:a.message}),n.dirty()):a.kind==="duration"?OP.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"duration",code:F.invalid_string,message:a.message}),n.dirty()):a.kind==="ip"?$P(e.data,a.version)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"ip",code:F.invalid_string,message:a.message}),n.dirty()):a.kind==="jwt"?UP(e.data,a.alg)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"jwt",code:F.invalid_string,message:a.message}),n.dirty()):a.kind==="cidr"?zP(e.data,a.version)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"cidr",code:F.invalid_string,message:a.message}),n.dirty()):a.kind==="base64"?BP.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"base64",code:F.invalid_string,message:a.message}),n.dirty()):a.kind==="base64url"?MP.test(e.data)||(i=this._getOrReturnCtx(e,i),V(i,{validation:"base64url",code:F.invalid_string,message:a.message}),n.dirty()):ue.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:F.invalid_string,...J.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...J.errToObj(e)})}url(e){return this._addCheck({kind:"url",...J.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...J.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...J.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...J.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...J.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...J.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...J.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...J.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...J.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...J.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...J.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...J.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...J.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...J.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...J.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...J.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...J.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...J.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...J.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...J.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...J.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...J.errToObj(r)})}nonempty(e){return this.min(1,J.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Br.create=t=>new Br({checks:[],typeName:ne.ZodString,coerce:t?.coerce??!1,...se(t)});function QP(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(".","")),s=Number.parseInt(e.toFixed(i).replace(".",""));return a%s/10**i}var vn=class t extends le{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==H.number){let a=this._getOrReturnCtx(e);return V(a,{code:F.invalid_type,expected:H.number,received:a.parsedType}),ee}let n,i=new tt;for(let a of this._def.checks)a.kind==="int"?ue.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),V(n,{code:F.invalid_type,expected:"integer",received:"float",message:a.message}),i.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),V(n,{code:F.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),V(n,{code:F.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="multipleOf"?QP(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),V(n,{code:F.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),V(n,{code:F.not_finite,message:a.message}),i.dirty()):ue.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,J.toString(r))}gt(e,r){return this.setLimit("min",e,!1,J.toString(r))}lte(e,r){return this.setLimit("max",e,!0,J.toString(r))}lt(e,r){return this.setLimit("max",e,!1,J.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:J.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:J.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:J.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:J.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:J.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:J.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:J.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:J.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:J.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:J.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ue.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};vn.create=t=>new vn({checks:[],typeName:ne.ZodNumber,coerce:t?.coerce||!1,...se(t)});var gn=class t extends le{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==H.bigint)return this._getInvalidInput(e);let n,i=new tt;for(let a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),V(n,{code:F.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),V(n,{code:F.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),V(n,{code:F.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):ue.assertNever(a);return{status:i.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return V(r,{code:F.invalid_type,expected:H.bigint,received:r.parsedType}),ee}gte(e,r){return this.setLimit("min",e,!0,J.toString(r))}gt(e,r){return this.setLimit("min",e,!1,J.toString(r))}lte(e,r){return this.setLimit("max",e,!0,J.toString(r))}lt(e,r){return this.setLimit("max",e,!1,J.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:J.tonpm warn config production Use `--omit=dev` instead.